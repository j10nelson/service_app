<% if current_user.role == "client" || "worker" %>


<div class="job-show">
  <h1>
  <%= @job.service.trade.name.capitalize %></h1>
  <div class="job-details">


<p>Service: <%= @job.service.type_of_service %></p>
<p>Price: <%= @job.service.price %></p>

<h1><%= @job.title %></h1>
<p><%= @job.date.strftime('%B %d, %Y') %></p>
<p><%= @job.time.strftime('%I:%M%p') %></p>
<p>Notes: <%= @job.note %></p>
<h2><%= @job.user.home_address %></h2>

</div>

<% if @job.history? %>
<p>Worker Name: <b><%= @job.worker.first_name %> <%= @job.worker.last_name %></b></p>
<p>Status: Job Closed</p>
<p>Reviews:</p>
  <% @job.reviews.each do |review| %>
    <p>Role <%= review.user.role.capitalize %></p>
    <p>Reviewed by: <%= review.user.first_name.capitalize %> <%= review.user.last_name.capitalize %></p>
    <p>Rating: <%= review.rating %></p>
    <p>Comments: <%= review.comment %></p>
    <% end %>

    <% if current_user.role == "client" || "worker" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&q= <%= @job.user.home_address.split %>" allowfullscreen>
    </iframe>

    <% end %>

    <% elsif @job.job_completed? %>
    <p>Worker Name: <b><%= @job.worker.first_name %> <%= @job.worker.last_name %></b></p>
    <% if current_user.role == "client" || "worker" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&q= <%= @job.user.home_address.split %>" allowfullscreen>
    </iframe>
  <% end %>

  <% elsif @job.accepted? %>
    <p>Worker Name: <b><%= @job.worker.first_name %> <%= @job.worker.last_name %></b></p>
    <% if current_user.role == "worker" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src=" https://www.google.com/maps/embed/v1/directions?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&origin= <%= @job.user.home_address.split %>&destination=<%= @job.worker.home_address.split %>&avoid=tolls|highways" allowfullscreen>
    </iframe>

    <% elsif current_user.role == "client" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&q= <%= @job.user.home_address.split %>" allowfullscreen>
    </iframe>
    <% end %>

  <% else @job.pending? %>
    <p>Status: <b> Awaiting Acceptance</b></p>

    <%= link_to "Edit", edit_trade_job_path(@job.service.trade, @job) %> |
    <%= link_to "Delete", @job, method: :delete, data: {confirm: "Are you sure you want to delete this service request?"} %><br>


    <% if current_user.role == "worker" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src=" https://www.google.com/maps/embed/v1/directions?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&origin= <%= @job.user.home_address.split %>&destination=<%= @user.home_address.split %>&avoid=tolls|highways" allowfullscreen>
    </iframe>

    <% elsif current_user.role == "client" %>
    <iframe
      width="500"
      height="450"
      frameborder="0" style="border:0"
      src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCdwSfbD9qCgu0qgvlo0XPi9Lw2ox13UuY&q= <%= @job.user.home_address.split %>" allowfullscreen>
    </iframe>
    <% end %>
      <br>
    <br><%= link_to "Back to Account", current_user %> |
    <%= link_to "Home", root_path %>
  <% end %>



</div>
<% end %>
