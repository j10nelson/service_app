<% if current_user.role == "client" %>
<div class="user-dashboard">
</div>
<div class="side-menu">
  <div class="account-side-menu">
  <%= link_to "Book new service!", trades_path %></%>
  <ul>
  <h3>Account</h3>
  <li><a href="#">Personal</a></li>
  <li><a href="#">Billing</a></li>
  </ul>
    </div>
</div>
<div class="dashboard-feed">
<h3>My Rating</h3>

<%= @client_rating %>

  <h2>My Account</h2>
  <h3><%= @user.role.capitalize%> Dashboard</p></h3>
  <p>Name: <%= @user.first_name %> <%= @user.last_name %></p>
  <p>Email: <%= @user.email %></p>
  <% if @user.filled_home_address? %>
  <p>Address: <%= @user.home_address %></p>
  <% end %>

<div class="jobs-dashboard">
  <h1>Jobs Pending: <%= @jobs_pending_client.count %></h1>
    <% @jobs_pending_client.each do |job| %>
      <h2 class="job-title">
      <%= link_to job_path(job) do %>
      <%= job.service.trade.name %>
    <p>Service: <%= job.service.type_of_service %></p>
    <% end %>
    <p>Price: <%= job.service.price %></p>
      </h2>
    <p><%= job.date.strftime('%B %d, %Y') %></p>
    <p><%= job.time.strftime('%I:%M%p')%></p>
    <p>Note: <%= job.note %></p>
    <% if job.job_pending? %>
      <p>Status: <b> Awaiting Acceptance</b></p>

      <%= link_to "Edit", edit_trade_job_path(job.service.trade, job) %> |
      <%= link_to "Delete", job_path(job), method: :delete, data: {confirm: "Are you sure you want to delete this service request?"}  %>
      <% end %>
      <% end %>

</div>
<div class="jobs-dashboard">
  <h1>Jobs Accepted: <%= @jobs_accepted_client.count %></h1>
      <% @jobs_accepted_client.each do |job| %>
      <h2 class="job-title">
    <%= link_to job_path(job) do %>
    <%= job.service.trade.name %>
      <p>Service: <%= job.service.type_of_service.capitalize %></p>
      <% end %>
      <p>Price: <%= job.service.price %></p>
      </h2>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <p>Address: <%= job.user.home_address %></p>
      <% if job.job_accepted? %>
      <p>Worker Name: <b><%= job.worker.first_name %> <%= job.worker.last_name %></b></p>
      <%= link_to "Cancel Request", job_path(job), method: :delete, data: {confirm: "Are you sure you want to delete this service request?"}  %>
    <% end %>
  <% end %>
</div>
<div class="jobs-dashboard">
  <h1>Jobs To Be Closed: <%=  @jobs_completed_client.count %></h1>
      <% @jobs_completed_client.each do |job| %>
      <h2 class="job-title">
    <%= link_to job_path(job) do %>
    <%= job.service.trade.name %>
      <p>Service: <%= job.service.type_of_service.capitalize %></p>
      <% end %>
      <p>Price: <%= job.service.price %></p>
        </h2>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <p>Address: <%= job.user.home_address %></p>
      <% if job.worker_done? %>
      <p>Worker Name: <b><%= job.worker.first_name %> <%= job.worker.last_name %></b></p>
      <%= link_to "Close Job", new_job_review_path(job) %><br><br>
          <% end %>
      <% end %>
</div>
<div class="jobs-dashboard">
  <h1>Closed Jobs : <%= @jobs_history_client.count %> </h1>
      <% @jobs_history_client.each do |job| %>
      <h2 class="job-title">
    <%= link_to job_path(job) do %>
    <%= job.service.trade.name %>
      <p>Service: <%= job.service.type_of_service.capitalize %></p>
      <% end %>
      <p>Price: <%= job.service.price %></p>
    </h2>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <% end %>
<% end %>
</div>
</div>


<% if current_user.role == "worker" %>
<div class="user-dashboard">
<%= @user.role.capitalize%> Dashboard</p>
</div>
<div class="side-menu">
  <div class="account-side-menu">
    <ul>
    <h3>Account</h3>
    <li><a href="#">Personal</a></li>
    <li><a href="#">Billing</a></li>
    </ul>
    </div>
</div>
<div class="dashboard-feed">
  <h3>My Rating</h3>
<%= @worker_rating %>
  <h2>My Account</h2>

   <% if @user.home_address? %>
   <h1>Complete Your Account</h1>
   <h3>Before you can book your first service request, you must complete your account by adding your primary address</h3>
  <%= render 'form_home_address_worker' %>
  <% else @user.filled_home_address? %>

  <p>Name: <%= @user.first_name %> <%= @user.last_name %></p>
  <p>Email: <%= @user.email %></p>
<h2> <%= @user.trade.name.capitalize%> </h2>

<div class="jobs-dashboard">
<h1>Jobs Pending: <%= @jobs_pending_worker.count %> </h1>
    <% @jobs_pending_worker.each do |job| %>
  <%= link_to job_path(job) do %>
    <h3>Service: <%= job.service.type_of_service.capitalize %></h3>
    <% end %>
    <p>Price: <%= job.service.price %></p>
    <p><%= job.date.strftime('%B %d, %Y') %></p>
    <p><%= job.time.strftime('%I:%M%p')%></p>
    <p>Note: <%= job.note %></p>

    <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
    <p>Address: <%= job.user.home_address %></p>

  <% if job.job_pending? %>
      <%= form_tag(job_accept_path(job), method: "put") do %>
        <%= submit_tag ("Accept") %>
      <% end %>
    <% end %>
  <% end %>
</div>

  <div class="jobs-dashboard">
  <h1>Jobs Accepted: <%= @jobs_accepted_worker.count %></h1>
      <% @jobs_accepted_worker.each do |job| %>
    <%= link_to job_path(job) do %>
      <h3>Service: <%= job.service.type_of_service.capitalize %></h3>
      <% end %>
      <p>Price: <%= job.service.price %></p>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <p>Address: <%= job.user.home_address %></p>
      <% if job.job_accepted? %>
      <p>Status: In Progress</p>
      <%= link_to "Close Job", new_job_review_path(job) %>
            <% end %>
      <% end %>
</div>

<div class="jobs-dashboard">
  <h1>Jobs Completed: <%= @jobs_completed_worker.count %> </h1>
      <% @jobs_completed_worker.each do |job| %>
    <%= link_to job_path(job) do %>
      <h3>Service: <%= job.service.type_of_service.capitalize %></h3>
      <% end %>
      <p>Price: <%= job.service.price %></p>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <p>Address: <%= job.user.home_address %></p>
      <% if job.job_completed? %>
      <p>Status: Job Closed</p>
      <h4>Review</h4>

        <% job.reviews.each do |review| %>
          <p>Comments: <%= review.comment %></p>
          <% end %>
          <% end %>
      <% end %>
</div>
<div class="jobs-dashboard">
  <h1>History: <%= @jobs_history_worker.count %> </h1>
      <% @jobs_history_worker.each do |job| %>
    <%= link_to job_path(job) do %>
      <h3>Service: <%= job.service.type_of_service.capitalize %></h3>
      <% end %>
      <p>Price: <%= job.service.price %></p>
      <p><%= job.date.strftime('%B %d, %Y') %></p>
      <p><%= job.time.strftime('%I:%M%p')%></p>
      <p>Note: <%= job.note %></p>

      <p>Name: <%= job.user.first_name %> <%= job.user.last_name %></p>
      <p>Address: <%= job.user.home_address %></p>
      <% end %>
  <% end %>
<% end %>
</div>
</div>

<% if current_user.role == "admin" %>
<div class="user-dashboard">
<%= @user.role.capitalize%> Dashboard</p>
</div>
<div class="side-menu">
  <div class="account-side-menu">
    <ul>
    <h3>Account</h3>
    <li><a href="#">Personal</a></li>
    <li><a href="#">Billing</a></li>
    </ul>
    </div>

    <div class="service-side-menu">
    <ul>
    <h3> Services </h3>
    <li><%= link_to "Create a service", new_service_url %></li>
    <h3> Trade </h3>
    <li><%= link_to "Create a trade", new_trade_url %></li>
  </ul>
      </div>

      <div class="job-side-menu">
      <h3> Jobs </h3>
        </div>
</div>
<div class="dashboard-feed">


  <h2>My Account</h2>
  <p>Name: <%= @user.first_name %> <%= @user.last_name %></p>
  <p>Email: <%= @user.email %></p>
<h2><%= @user.role.capitalize %></h2>
<h2>Jobs Pending: <%= @jobs_pending %></h2>
<h2>Job Accepted: <%= @jobs_accepted %></h2>
<% end %>
</div>
