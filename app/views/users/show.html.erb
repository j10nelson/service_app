<p><%= @user.role.capitalize%> Dashboard</p>
<h2>My Account</h2>
<p>Name: <%= @user.first_name %> <%= @user.last_name %></p>
<p>Email: <%= @user.email %></p>

<% if current_user.role == "client" %>
  <h2>Jobs Pending: <%= @jobs_pending %></h2>
  <h2>Jobs Accepted: <%= @jobs_accepted %></h2>

    <% @user.jobs.each do |job| %>
      <h2 class="job-title">

      <%= link_to job_path(job) do %>
      <%= job.service.trade.capitalize %></h2>
      <p>Service: <%= job.service.type_of_service %></p>
      <% end %>

    <p><%= job.date.strftime('%B %d, %Y') %></p>
    <p><%= job.time.strftime('%I:%M%p')%></p>
    <p>Note: <%= job.notes %></p>


      <% if job.accepted? && job.worker_done? && job.client_done? %>
        <p>Worker Name: <b><%= job.worker.first_name %> <%= job.worker.last_name %></b></p>
        <p>Status: Job Closed</p>
        <p>Reviews:</p>
          <% job.reviews.each do |review| %>
            <p>Reviewed by: <%= review.user.role.capitalize %></p>
            <p>Role <%= review.user.first_name.capitalize %> <%= review.user.last_name.capitalize %></p>
            <p>Rating: <%= review.rating %></p>
            <p>Comments: <%= review.comments %></p>
          <% end %>
        <%= link_to "Delete", job_path(job), method: :delete, data: {confirm: "Are you sure you want to delete this service request?"}  %>


      <% elsif job.accepted? && job.worker_done? %>
        <p>Worker Name: <b><%= job.worker.first_name %> <%= job.worker.last_name %></b></p>
        <%= link_to "Close Job", new_job_review_path(job) %><br><br>

      <% elsif job.accepted? %>
        <p>Worker Name: <b><%= job.worker.first_name %> <%= job.worker.last_name %></b></p>
        <%= link_to "Delete", job_path(job), method: :delete, data: {confirm: "Are you sure you want to delete this service request?"}  %>

      <% else job.pending? %>
        <p>Status: <b> Awaiting Acceptance</b></p>

        <%= link_to "Edit", edit_service_job_path(job.service, job) %> |
        <%= link_to "Delete", job_path(job), method: :delete, data: {confirm: "Are you sure you want to delete this service request?"}  %>
      <% end %>

    <% end %>

  <%= link_to "Back to Home", root_path %>

<% end %>


<% if current_user.role == "worker" %>
  <h2><%= @user.trade.capitalize %></h2>
  <h2>Jobs Pending: <%= @jobs_pending %></h2>
  <h2>Job Accepted: <%= @jobs_accepted %></h2>

  <% @jobs_from_requested_services.each do |job| %>

    <%= link_to job_path(job) do %>
    <h3>Service: <%= job.service.type_of_service.capitalize %></h3>
    <% end %>

    <p><%= job.date.strftime('%B %d, %Y') %></p>
    <p><%= job.time.strftime('%I:%M%p')%></p>
    <p>Note: <%= job.notes %></p>

    <% if job.accepted? && job.worker_done? %>
      <p>Status: Job Closed</p>
      <p>Reviews:</p>
        <% job.reviews.each do |review| %>
          <p>Reviewed by: <%= review.user.role.capitalize %></p>
          <p>Role <%= review.user.first_name.capitalize %> <%= review.user.last_name.capitalize %></p>
          <p>Rating: <%= review.rating %></p>
          <p>Comments: <%= review.comments %></p>
        <% end %>


    <% elsif job.accepted? %>
      <p>Status: In Progress</p>
      <%= link_to "Close Job", new_job_review_path(job) %>

    <% else %>
      <%= form_tag(job_accept_path(job), method: "put") do %>
        <%= submit_tag ("Accept") %>
      <% end %>
    <% end %>

  <% end %>

<% end %>
